---
title: 'Reproducible Research: Peer Assessment 2'
author: "Jörg Mülller"
date: "10/20/2014"
output: html_document
---


1. Across the United States, which types of events (as indicated in the EVTYPE variable) are most harmful with respect to population health?

2. Across the United States, which types of events have the greatest economic consequences?

## US Storm Data Analysis

Synopsis 
--------
Immediately after the title, there should be a synopsis which describes and summarizes your analysis in at most 10 complete sentences.


## Data Processing

Read the data file and take a look at its structure: 
```{r, echo=TRUE, cache=TRUE}

df <- read.csv('repdata_data_StormData.csv', header=T, sep=",")

str(df)
head(df)

nrow(df)
```

Convert the EVTYPE variable to lowercase and group most of them into high-level event types. This was done by hand and is probably not very accurate, but helps to reduce the >900 event types into more manageable clusters. 

```{r, echo=TRUE, cache=TRUE}

df$evtype <- tolower(df[,8])

df[grep("torn*", df$evtype),]$evtype <- c("tornado")
df[grep("thunderstorm*|tstm*|storm*|downburst", df$evtype),]$evtype <- c("thunderstorm")
df[grep("blizzard*", df$evtype),]$evtype <- c("blizzard")
df[grep("flood*|water*|surf*|swells*|tsunami*|fldg|fld|stream", df$evtype),]$evtype <- c("flood")
df[grep("snow*", df$evtype),]$evtype <- c("snow")
df[grep("*wind*|wnd", df$evtype),]$evtype <- c("wind")
df[grep("cold*|frost*|chill*|freez*|glaze*|ice*|low*|cool*", df$evtype),]$evtype <- c("cold")
df[grep("rain*|wet*|percipi*|preci*|shower*", df$evtype),]$evtype <- c("rain")
df[grep("dry*|heat*|drought*|high*|warm*|dust*|hot", df$evtype),]$evtype <- c("heat")
df[grep("hail*|sleet*", df$evtype),]$evtype <- c("hail")
df[grep("hurricane*|typh*", df$evtype),]$evtype <- c("hurricane")
df[grep("light*|lign*", df$evtype),]$evtype<- c("lightning")
df[grep("*slide*", df$evtype),]$evtype<- c("slide")
df[grep("*fire*|smoke*", df$evtype),]$evtype<- c("fire")
df[grep("avalanc*", df$evtype),]$evtype<- c("avalanche")
df[grep("fog*|vog", df$evtype),]$evtype<- c("fog")
df[grep("dam*", df$evtype),]$evtype<- c("dam break")
df[grep("rip*", df$evtype),]$evtype<- c("rip current")
df[grep("erosi*", df$evtype),]$evtype<- c("erosion")
df[grep("rogue|rough", df$evtype),]$evtype<- c("rough sea")
df[grep("apache|summary*|excessive|funnel*|gustnado|hypothermia|landslump|landspout|marine*|mild|monthly|none|other|record*|red|turbulence|record|urban*|way*", df$evtype),]$evtype<- c("other")

```

After this grouping, the `r nrow(df)` rows of the dataset are distributed across the following categories: 

```{r, echo=TRUE}
table(df$evtype)
```




## Results
There should be a section titled Results in which your results are presented.

You may have other sections in your analysis, but Data Processing and Results are required.

The analysis document must have at least one figure containing a plot.

Your analyis must have no more than three figures. Figures may have multiple plots in them (i.e. panel plots), but there cannot be more than three figures total.



You must show all your code for the work in your analysis document. This may make the document a bit verbose, but that is okay. In general, you should ensure that echo = TRUE for every code chunk (this is the default setting in knitr).